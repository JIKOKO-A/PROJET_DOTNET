<UserControl x:Class="HRManagementApp.Views.EmployeeView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:vm="clr-namespace:HRManagementApp.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="600" d:DesignWidth="1000">
    <UserControl.DataContext>
        <vm:EmployeeViewModel />
    </UserControl.DataContext>
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Search and Add Button -->
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,10">
            <TextBox Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                    Width="300" 
                    Margin="0,0,10,0"
                    Padding="5"
                    FontSize="14"/>
            <Button Content="Add Employee" 
                   Command="{Binding AddEmployeeCommand}" 
                   Padding="15,8"
                   Background="#27AE60"
                   Foreground="White"
                   BorderThickness="0"
                   Cursor="Hand"/>
        </StackPanel>
        
        <!-- Employee List -->
        <DataGrid Grid.Row="1" 
                 ItemsSource="{Binding Employees}" 
                 SelectedItem="{Binding SelectedEmployee}"
                 AutoGenerateColumns="False"
                 IsReadOnly="True"
                 GridLinesVisibility="All"
                 HeadersVisibility="Column"
                 SelectionMode="Single">
            <DataGrid.Columns>
                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="50"/>
                <DataGridTextColumn Header="First Name" Binding="{Binding FirstName}" Width="150"/>
                <DataGridTextColumn Header="Last Name" Binding="{Binding LastName}" Width="150"/>
                <DataGridTextColumn Header="Email" Binding="{Binding Email}" Width="200"/>
                <DataGridTextColumn Header="Phone" Binding="{Binding Phone}" Width="120"/>
                <DataGridTextColumn Header="Position" Binding="{Binding Position}" Width="150"/>
                <DataGridTextColumn Header="Department" Binding="{Binding Department.Name}" Width="120"/>
                <DataGridTextColumn Header="Salary" Binding="{Binding Salary, StringFormat='{}{0:N2} MAD'}" Width="100"/>
                <DataGridTextColumn Header="Hire Date" Binding="{Binding HireDate, StringFormat=d}" Width="100"/>
            </DataGrid.Columns>
        </DataGrid>
        
        <!-- Edit Panel -->
        <ScrollViewer Grid.Row="2" 
                     VerticalScrollBarVisibility="Auto" 
                     HorizontalScrollBarVisibility="Disabled"
                     Margin="0,10,0,0"
                     Visibility="{Binding IsEditMode, Converter={StaticResource BoolToVisibilityConverter}}"
                     MaxHeight="500">
            <Border BorderBrush="#BDC3C7" 
                   BorderThickness="1" 
                   Padding="15">
                <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                
                <TextBlock Grid.Row="0" Grid.ColumnSpan="2" Text="Employee Details" FontSize="18" FontWeight="Bold" Margin="0,0,0,15"/>
                
                <TextBlock Grid.Row="1" Grid.Column="0" Text="First Name:" Margin="0,5" VerticalAlignment="Center"/>
                <TextBox Grid.Row="1" Grid.Column="1" Text="{Binding SelectedEmployee.FirstName}" Margin="5" VerticalAlignment="Center"/>
                
                <TextBlock Grid.Row="2" Grid.Column="0" Text="Last Name:" Margin="0,5" VerticalAlignment="Center"/>
                <TextBox Grid.Row="2" Grid.Column="1" Text="{Binding SelectedEmployee.LastName}" Margin="5" VerticalAlignment="Center"/>
                
                <TextBlock Grid.Row="3" Grid.Column="0" Text="Email:" Margin="0,5" VerticalAlignment="Center"/>
                <TextBox Grid.Row="3" Grid.Column="1" Text="{Binding SelectedEmployee.Email}" Margin="5" VerticalAlignment="Center"/>
                
                <TextBlock Grid.Row="4" Grid.Column="0" Text="Phone:" Margin="0,5" VerticalAlignment="Center"/>
                <TextBox Grid.Row="4" Grid.Column="1" Text="{Binding SelectedEmployee.Phone}" Margin="5" VerticalAlignment="Center"/>
                
                <TextBlock Grid.Row="5" Grid.Column="0" Text="Department:" Margin="0,5" VerticalAlignment="Center"/>
                <ComboBox Grid.Row="5" Grid.Column="1" 
                         ItemsSource="{Binding Departments}" 
                         SelectedValue="{Binding SelectedEmployee.DepartmentId}"
                         SelectedValuePath="Id"
                         DisplayMemberPath="Name"
                         Margin="5"
                         VerticalAlignment="Center"/>
                
                <TextBlock Grid.Row="6" Grid.Column="0" Text="Position:" Margin="0,5" VerticalAlignment="Center"/>
                <TextBox Grid.Row="6" Grid.Column="1" Text="{Binding SelectedEmployee.Position}" Margin="5" VerticalAlignment="Center"/>
                
                <TextBlock Grid.Row="7" Grid.Column="0" Text="Salary:" Margin="0,5" VerticalAlignment="Center"/>
                <TextBox Grid.Row="7" Grid.Column="1" Text="{Binding SelectedEmployee.Salary}" Margin="5" VerticalAlignment="Center"/>
                
                <TextBlock Grid.Row="8" Grid.Column="0" Text="Hire Date:" Margin="0,5" VerticalAlignment="Center"/>
                <DatePicker Grid.Row="8" Grid.Column="1" 
                           SelectedDate="{Binding SelectedEmployee.HireDate}" 
                           Margin="5"
                           VerticalAlignment="Center"/>
                
                <StackPanel Grid.Row="9" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
                    <Button Content="Save" 
                           Command="{Binding SaveEmployeeCommand}" 
                           Margin="5" 
                           Padding="20,8"
                           Background="#27AE60"
                           Foreground="White"
                           BorderThickness="0"
                           Cursor="Hand"/>
                    <Button Content="Delete" 
                           Command="{Binding DeleteEmployeeCommand}" 
                           Margin="5" 
                           Padding="20,8"
                           Background="#E74C3C"
                           Foreground="White"
                           BorderThickness="0"
                           Cursor="Hand"/>
                    <Button Content="Cancel" 
                           Command="{Binding CancelEditCommand}" 
                           Margin="5" 
                           Padding="20,8"
                           Background="#95A5A6"
                           Foreground="White"
                           BorderThickness="0"
                           Cursor="Hand"/>
                </StackPanel>
                </Grid>
            </Border>
        </ScrollViewer>
    </Grid>
</UserControl>


